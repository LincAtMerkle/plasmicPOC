{"version":3,"file":"host.esm.js","sources":["../src/lang-utils.ts","../src/useForceUpdate.ts","../src/canvas-host.tsx","../src/common.ts","../src/data.tsx","../src/fetcher.ts","../src/registerComponent.ts","../src/registerGlobalContext.ts","../src/registerTrait.ts","../src/repeatedElement.ts","../src/version.ts","../src/index.ts"],"sourcesContent":["function isString(x: any): x is string {\n  return typeof x === \"string\";\n}\n\ntype StringGen = string | (() => string);\n\nexport function ensure<T>(x: T | null | undefined, msg: StringGen = \"\"): T {\n  if (x === null || x === undefined) {\n    debugger;\n    msg = (isString(msg) ? msg : msg()) || \"\";\n    throw new Error(\n      `Value must not be undefined or null${msg ? `- ${msg}` : \"\"}`\n    );\n  } else {\n    return x;\n  }\n}\n","import { useCallback, useState } from \"react\";\n\nexport default function useForceUpdate() {\n  const [, setTick] = useState(0);\n  const update = useCallback(() => {\n    setTick((tick) => tick + 1);\n  }, []);\n  return update;\n}\n","import * as React from \"react\";\nimport * as ReactDOM from \"react-dom\";\nimport { ensure } from \"./lang-utils\";\nimport useForceUpdate from \"./useForceUpdate\";\nconst root = globalThis as any;\n\ndeclare global {\n  interface Window {\n    __PlasmicHostVersion: string;\n  }\n}\n\nif (root.__PlasmicHostVersion == null) {\n  root.__PlasmicHostVersion = \"2\";\n}\n\nconst rootChangeListeners: (() => void)[] = [];\nclass PlasmicRootNodeWrapper {\n  constructor(private value: null | React.ReactElement) {}\n  set = (val: null | React.ReactElement) => {\n    this.value = val;\n    rootChangeListeners.forEach((f) => f());\n  };\n  get = () => this.value;\n}\n\nconst plasmicRootNode = new PlasmicRootNodeWrapper(null);\n\nfunction getPlasmicOrigin() {\n  const params = new URL(`https://fakeurl/${location.hash.replace(/#/, \"?\")}`)\n    .searchParams;\n  return ensure(\n    params.get(\"origin\"),\n    \"Missing information from Plasmic window.\"\n  );\n}\n\nfunction renderStudioIntoIframe() {\n  const script = document.createElement(\"script\");\n  const plasmicOrigin = getPlasmicOrigin();\n  script.src = plasmicOrigin + \"/static/js/studio.js\";\n  document.body.appendChild(script);\n}\n\nlet renderCount = 0;\nexport function setPlasmicRootNode(node: React.ReactElement | null) {\n  // Keep track of renderCount, which we use as key to ErrorBoundary, so\n  // we can reset the error on each render\n  renderCount++;\n  plasmicRootNode.set(node);\n}\n\n/**\n * React context to detect whether the component is rendered on Plasmic editor.\n * If not, return false.\n * If so, return an object with more information about the component\n */\nexport const PlasmicCanvasContext = React.createContext<\n  | {\n      componentName: string | null;\n      globalVariants: Record<string, string>;\n    }\n  | false\n>(false);\nexport const usePlasmicCanvasContext = () =>\n  React.useContext(PlasmicCanvasContext);\n\nfunction _PlasmicCanvasHost() {\n  // If window.parent is null, then this is a window whose containing iframe\n  // has been detached from the DOM (for the top window, window.parent === window).\n  // In that case, we shouldn't do anything.  If window.parent is null, by the way,\n  // location.hash will also be null.\n  const isFrameAttached = !!window.parent;\n  const isCanvas = !!location.hash?.match(/\\bcanvas=true\\b/);\n  const isLive = !!location.hash?.match(/\\blive=true\\b/) || !isFrameAttached;\n  const shouldRenderStudio =\n    isFrameAttached &&\n    !document.querySelector(\"#plasmic-studio-tag\") &&\n    !isCanvas &&\n    !isLive;\n  const locationHash = new URLSearchParams(location.hash);\n\n  const [activeGlobalVariants, setActiveGlobalVariants] = React.useState<\n    Record<string, string>\n  >(() => JSON.parse(locationHash.get(\"globalVariants\") ?? \"{}\"));\n  const forceUpdate = useForceUpdate();\n  React.useLayoutEffect(() => {\n    rootChangeListeners.push(forceUpdate);\n    return () => {\n      const index = rootChangeListeners.indexOf(forceUpdate);\n      if (index >= 0) {\n        rootChangeListeners.splice(index, 1);\n      }\n    };\n  }, [forceUpdate]);\n  React.useEffect(() => {\n    if (shouldRenderStudio && isFrameAttached && window.parent !== window) {\n      renderStudioIntoIframe();\n    }\n  }, [shouldRenderStudio, isFrameAttached]);\n  React.useEffect(() => {\n    if (!shouldRenderStudio && !document.querySelector(\"#getlibs\") && isLive) {\n      const scriptElt = document.createElement(\"script\");\n      scriptElt.id = \"getlibs\";\n      scriptElt.src = getPlasmicOrigin() + \"/static/js/getlibs.js\";\n      scriptElt.async = false;\n      scriptElt.onload = () => {\n        (window as any).__GetlibsReadyResolver?.();\n      };\n      document.head.append(scriptElt);\n    }\n  }, [shouldRenderStudio]);\n  React.useEffect(() => {\n    const listener = (event: MessageEvent) => {\n      try {\n        const data = JSON.parse(event.data);\n        if (data.source === \"canvas-frame\") {\n          setActiveGlobalVariants(data.activeGlobalVariants);\n        }\n      } catch {}\n    };\n    window.addEventListener(\"message\", listener);\n    return () => window.removeEventListener(\"message\", listener);\n  }, []);\n  if (!isFrameAttached) {\n    return null;\n  }\n  if (isCanvas || isLive) {\n    let appDiv = document.querySelector(\"#plasmic-app.__wab_user-body\");\n    if (!appDiv) {\n      appDiv = document.createElement(\"div\");\n      appDiv.id = \"plasmic-app\";\n      appDiv.classList.add(\"__wab_user-body\");\n      document.body.appendChild(appDiv);\n    }\n    const plasmicContextValue = isCanvas\n      ? {\n          componentName: locationHash.get(\"componentName\"),\n          globalVariants: activeGlobalVariants,\n        }\n      : false;\n    return ReactDOM.createPortal(\n      <ErrorBoundary key={`${renderCount}`}>\n        <PlasmicCanvasContext.Provider value={plasmicContextValue}>\n          {plasmicRootNode.get()}\n        </PlasmicCanvasContext.Provider>\n      </ErrorBoundary>,\n      appDiv,\n      \"plasmic-app\"\n    );\n  }\n  if (shouldRenderStudio && window.parent === window) {\n    return (\n      <iframe\n        src={`https://docs.plasmic.app/app-content/app-host-ready#appHostUrl=${encodeURIComponent(\n          location.href\n        )}`}\n        style={{\n          width: \"100vw\",\n          height: \"100vh\",\n          border: \"none\",\n          position: \"fixed\",\n          top: 0,\n          left: 0,\n          zIndex: 99999999,\n        }}\n      ></iframe>\n    );\n  }\n  return null;\n}\n\ninterface PlasmicCanvasHostProps {\n  /**\n   * Webpack hmr uses EventSource to\tlisten to hot reloads, but that\n   * resultsin a persistent\tconnection from\teach window.  In Plasmic\n   * Studio, if a project is configured to use app-hosting with a\n   * nextjs or gatsby server running in dev mode, each artboard will\n   * be holding a persistent connection to the dev server.\n   * Because browsers\thave a limit to\thow many connections can\n   * be held\tat a time by domain, this means\tafter X\tartboards, new\n   * artboards will freeze and not load.\n   *\n   * By default, <PlasmicCanvasHost /> will globally mutate\n   * window.EventSource to avoid using EventSource for HMR, which you\n   * typically don't need for your custom host page.  If you do still\n   * want to retain HRM, then youc an pass enableWebpackHmr={true}.\n   */\n  enableWebpackHmr?: boolean;\n}\n\nexport const PlasmicCanvasHost: React.FunctionComponent<PlasmicCanvasHostProps> = (\n  props\n) => {\n  const { enableWebpackHmr } = props;\n  const [node, setNode] = React.useState<React.ReactElement<any, any> | null>(\n    null\n  );\n  React.useEffect(() => {\n    setNode(<_PlasmicCanvasHost />);\n  }, []);\n  return (\n    <>\n      {!enableWebpackHmr && <DisableWebpackHmr />}\n      {node}\n    </>\n  );\n};\n\ntype RenderErrorListener = (err: Error) => void;\nconst renderErrorListeners: RenderErrorListener[] = [];\nexport function registerRenderErrorListener(listener: RenderErrorListener) {\n  renderErrorListeners.push(listener);\n  return () => {\n    const index = renderErrorListeners.indexOf(listener);\n    if (index >= 0) {\n      renderErrorListeners.splice(index, 1);\n    }\n  };\n}\n\ninterface ErrorBoundaryProps {\n  children?: React.ReactNode;\n}\n\ninterface ErrorBoundaryState {\n  error?: Error;\n}\n\nclass ErrorBoundary extends React.Component<\n  ErrorBoundaryProps,\n  ErrorBoundaryState\n> {\n  constructor(props: ErrorBoundaryProps) {\n    super(props);\n    this.state = {};\n  }\n\n  static getDerivedStateFromError(error: Error) {\n    return { error };\n  }\n\n  componentDidCatch(error: Error) {\n    renderErrorListeners.forEach((listener) => listener(error));\n  }\n\n  render() {\n    if (this.state.error) {\n      return <div>Error: {`${this.state.error.message}`}</div>;\n    } else {\n      return <>{this.props.children}</>;\n    }\n  }\n}\n\nfunction DisableWebpackHmr() {\n  if (process.env.NODE_ENV === \"production\") {\n    return null;\n  }\n  return (\n    <script\n      type=\"text/javascript\"\n      dangerouslySetInnerHTML={{\n        __html: `\n      if (typeof window !== \"undefined\") {\n        const RealEventSource = window.EventSource;\n        window.EventSource = function(url, config) {\n          if (/[^a-zA-Z]hmr($|[^a-zA-Z])/.test(url)) {\n            console.warn(\"Plasmic: disabled EventSource request for\", url);\n            return {\n              onerror() {}, onmessage() {}, onopen() {}, close() {}\n            };\n          } else {\n            return new RealEventSource(url, config);\n          }\n        }\n      }\n      `,\n      }}\n    ></script>\n  );\n}\n","export const tuple = <T extends any[]>(...args: T): T => args;\n","import React, {\n  createContext,\n  ReactElement,\n  ReactNode,\n  useContext,\n} from \"react\";\nimport { tuple } from \"./common\";\n\nexport type DataDict = Record<string, any>;\n\nexport const DataContext = createContext<DataDict | undefined>(undefined);\n\nexport type DataMeta = {\n  hidden?: boolean;\n  label?: string;\n};\n\nexport function mkMetaName(name: string) {\n  return `__plasmic_meta_${name}`;\n}\n\nexport function mkMetaValue(meta: Partial<DataMeta>): DataMeta {\n  return meta;\n}\n\nexport function applySelector(\n  rawData: DataDict | undefined,\n  selector: string | undefined\n): any {\n  if (!selector) {\n    return undefined;\n  }\n  let curData = rawData;\n  for (const key of selector.split(\".\")) {\n    curData = curData?.[key];\n  }\n  return curData;\n}\n\nexport type SelectorDict = Record<string, string | undefined>;\n\nexport function useSelector(selector: string | undefined): any {\n  const rawData = useDataEnv();\n  return applySelector(rawData, selector);\n}\n\nexport function useSelectors(selectors: SelectorDict = {}): any {\n  const rawData = useDataEnv();\n  return Object.fromEntries(\n    Object.entries(selectors)\n      .filter(([key, selector]) => !!key && !!selector)\n      .map(([key, selector]) => tuple(key, applySelector(rawData, selector)))\n  );\n}\n\nexport function useDataEnv() {\n  return useContext(DataContext);\n}\n\nexport interface DataProviderProps {\n  /**\n   * Key to set in data context.\n   */\n  name?: string;\n  /**\n   * Value to set for `name` in data context.\n   */\n  data?: any;\n  /**\n   * If true, hide this entry in studio (data binding).\n   */\n  hidden?: boolean;\n  /**\n   * Label to be shown in the studio data picker for easier navigation (data binding).\n   */\n  label?: string;\n  children?: ReactNode;\n}\n\nexport function DataProvider({\n  name,\n  data,\n  hidden,\n  label,\n  children,\n}: DataProviderProps) {\n  const existingEnv = useDataEnv() ?? {};\n  if (!name) {\n    return <>{children}</>;\n  } else {\n    return (\n      <DataContext.Provider\n        value={{\n          ...existingEnv,\n          [name]: data,\n          [mkMetaName(name)]: mkMetaValue({ hidden, label }),\n        }}\n      >\n        {children}\n      </DataContext.Provider>\n    );\n  }\n}\n\nexport interface PageParamsProviderProps {\n  params?: Record<string, string | string[] | undefined>;\n  query?: Record<string, string | string[] | undefined>;\n  children?: ReactNode;\n}\n\nexport function PageParamsProvider({\n  children,\n  params = {},\n  query = {},\n}: PageParamsProviderProps) {\n  const $ctx = useDataEnv() || {};\n  return (\n    <DataProvider\n      name={\"params\"}\n      data={{ ...$ctx.params, ...params }}\n      label={\"Page route params\"}\n    >\n      <DataProvider\n        name={\"query\"}\n        data={{ ...$ctx.query, ...query }}\n        label={\"Page query params\"}\n      >\n        {children}\n      </DataProvider>\n    </DataProvider>\n  );\n}\n\nexport function DataCtxReader({\n  children,\n}: {\n  children: ($ctx: DataDict | undefined) => ReactNode;\n}) {\n  const $ctx = useDataEnv();\n  return children($ctx) as ReactElement | null;\n}\n","import { PrimitiveType } from \"./registerComponent\";\n\nconst root = globalThis as any;\n\nexport type Fetcher = (...args: any[]) => Promise<any>;\n\nexport interface FetcherMeta {\n  /**\n   * Any unique identifying string for this fetcher.\n   */\n  name: string;\n  /**\n   * The Studio-user-friendly display name.\n   */\n  displayName?: string;\n  /**\n   * The symbol to import from the importPath.\n   */\n  importName?: string;\n  args: { name: string; type: PrimitiveType }[];\n  returns: PrimitiveType;\n  /**\n   * Either the path to the fetcher relative to `rootDir` or the npm\n   * package name\n   */\n  importPath: string;\n  /**\n   * Whether it's a default export or named export\n   */\n  isDefaultExport?: boolean;\n}\n\nexport interface FetcherRegistration {\n  fetcher: Fetcher;\n  meta: FetcherMeta;\n}\n\ndeclare global {\n  interface Window {\n    __PlasmicFetcherRegistry: FetcherRegistration[];\n  }\n}\n\nroot.__PlasmicFetcherRegistry = [];\n\nexport function registerFetcher(fetcher: Fetcher, meta: FetcherMeta) {\n  root.__PlasmicFetcherRegistry.push({ fetcher, meta });\n}\n","import {\n  CodeComponentElement,\n  CSSProperties,\n  PlasmicElement,\n} from \"./element-types\";\n\nconst root = globalThis as any;\n\nexport interface CanvasComponentProps<Data = any> {\n  /**\n   * This prop is only provided within the canvas of Plasmic Studio.\n   * Allows the component to set data to be consumed by the props' controls.\n   */\n  setControlContextData?: (data: Data) => void;\n}\n\ntype InferDataType<P> = P extends CanvasComponentProps<infer Data> ? Data : any;\n\n/**\n * Config option that takes the context (e.g., props) of the component instance\n * to dynamically set its value.\n */\ntype ContextDependentConfig<P, R> = (\n  props: P,\n  /**\n   * `contextData` can be `null` if the prop controls are rendering before\n   * the component instance itself (it will re-render once the component\n   * calls `setControlContextData`)\n   */\n  contextData: InferDataType<P> | null\n) => R;\n\ninterface PropTypeBase<P> {\n  displayName?: string;\n  description?: string;\n  hidden?: ContextDependentConfig<P, boolean>;\n  readOnly?: boolean | ContextDependentConfig<P, boolean>;\n  advanced?: boolean;\n}\n\ntype DefaultValueOrExpr<P, T> =\n  | {\n      defaultExpr?: undefined;\n      defaultExprHint?: undefined;\n      defaultValue?: T;\n      defaultValueHint?: T | ContextDependentConfig<P, T | undefined>;\n    }\n  | {\n      defaultValue?: undefined;\n      defaultValueHint?: undefined;\n      defaultExpr?: string;\n      defaultExprHint?: string;\n    };\n\ntype StringTypeBase<P> = PropTypeBase<P> & DefaultValueOrExpr<P, string>;\n\nexport type StringType<P> =\n  | \"string\"\n  | ((\n      | {\n          type: \"string\";\n          control?: \"default\" | \"large\";\n        }\n      | {\n          type: \"code\";\n          lang: \"css\" | \"html\" | \"javascript\" | \"json\";\n        }\n      | {\n          type: \"cardPicker\";\n          modalTitle?:\n            | React.ReactNode\n            | ContextDependentConfig<P, React.ReactNode>;\n          options:\n            | {\n                value: string;\n                label?: string;\n                imgUrl: string;\n                footer?: React.ReactNode;\n              }[]\n            | ContextDependentConfig<\n                P,\n                {\n                  value: string;\n                  label?: string;\n                  imgUrl: string;\n                  footer?: React.ReactNode;\n                }[]\n              >;\n          showInput?: boolean | ContextDependentConfig<P, boolean>;\n          onSearch?: ContextDependentConfig<\n            P,\n            ((value: string) => void) | undefined\n          >;\n        }\n    ) &\n      StringTypeBase<P>);\n\nexport type BooleanType<P> =\n  | \"boolean\"\n  | ({\n      type: \"boolean\";\n    } & DefaultValueOrExpr<P, boolean> &\n      PropTypeBase<P>);\n\ntype GraphQLValue = {\n  query: string;\n  variables?: Record<string, any>;\n};\n\nexport type GraphQLType<P> = {\n  type: \"code\";\n  lang: \"graphql\";\n  endpoint: string | ContextDependentConfig<P, string>;\n  method?: string | ContextDependentConfig<P, string>;\n  headers?: object | ContextDependentConfig<P, object>;\n} & DefaultValueOrExpr<P, GraphQLValue> &\n  PropTypeBase<P>;\n\ntype NumberTypeBase<P> = PropTypeBase<P> &\n  DefaultValueOrExpr<P, number> & {\n    type: \"number\";\n  };\n\nexport type NumberType<P> =\n  | \"number\"\n  | ((\n      | {\n          control?: \"default\";\n          min?: number | ContextDependentConfig<P, number>;\n          max?: number | ContextDependentConfig<P, number>;\n        }\n      | {\n          control: \"slider\";\n          min: number | ContextDependentConfig<P, number>;\n          max: number | ContextDependentConfig<P, number>;\n          step?: number | ContextDependentConfig<P, number>;\n        }\n    ) &\n      NumberTypeBase<P>);\n\n/**\n * Expects defaultValue to be a JSON-compatible value\n */\nexport type JSONLikeType<P> =\n  | \"object\"\n  | ({\n      type: \"object\";\n    } & DefaultValueOrExpr<P, any> &\n      PropTypeBase<P>)\n  | ({\n      type: \"array\";\n    } & DefaultValueOrExpr<P, any[]> &\n      PropTypeBase<P>)\n  | ({\n      type: \"dataSource\";\n      dataSource: \"airtable\" | \"cms\";\n    } & PropTypeBase<P>)\n  | ({\n      type: \"dataSelector\";\n      data:\n        | Record<string, any>\n        | ContextDependentConfig<P, Record<string, any>>;\n      alwaysShowValuePathAsLabel?: boolean;\n    } & DefaultValueOrExpr<P, Record<string, any>> &\n      PropTypeBase<P>);\n\ninterface ChoiceTypeBase<P> extends PropTypeBase<P> {\n  type: \"choice\";\n  options:\n    | string[]\n    | {\n        label: string;\n        value: string | number | boolean;\n      }[]\n    | ContextDependentConfig<\n        P,\n        | string[]\n        | {\n            label: string;\n            value: string | number | boolean;\n          }[]\n      >;\n  allowSearch?: boolean;\n  filterOption?: boolean;\n  onSearch?: ContextDependentConfig<P, ((value: string) => void) | undefined>;\n}\n\nexport type ChoiceType<P> = (\n  | ({\n      multiSelect?: false;\n    } & DefaultValueOrExpr<P, string | number | boolean>)\n  | ({\n      multiSelect: true;\n    } & DefaultValueOrExpr<P, (string | number | boolean)[]>)\n) &\n  ChoiceTypeBase<P>;\n\nexport interface ModalProps {\n  show?: boolean;\n  children?: React.ReactNode;\n  onClose: () => void;\n  style?: CSSProperties;\n}\n\ninterface CustomControlProps<P> {\n  componentProps: P;\n  /**\n   * `contextData` can be `null` if the prop controls are rendering before\n   * the component instance itself (it will re-render once the component\n   * calls `setControlContextData`)\n   */\n  contextData: InferDataType<P> | null;\n  value: any;\n  /**\n   * Sets the value to be passed to the prop. Expects a JSON-compatible value.\n   */\n  updateValue: (newVal: any) => void;\n  /**\n   * Full screen modal component\n   */\n  FullscreenModal: React.ComponentType<ModalProps>;\n  /**\n   * Modal component for the side pane\n   */\n  SideModal: React.ComponentType<ModalProps>;\n\n  /**\n   * The document that the component will be rendered into; instead of using\n   * `document` directly (for, say, `document.querySelector()` etc.), you\n   * should use this instead.\n   */\n  studioDocument: typeof document;\n}\nexport type CustomControl<P> = React.ComponentType<CustomControlProps<P>>;\n\n/**\n * Expects defaultValue to be a JSON-compatible value\n */\nexport type CustomType<P> =\n  | CustomControl<P>\n  | ({\n      type: \"custom\";\n      control: CustomControl<P>;\n    } & PropTypeBase<P> &\n      DefaultValueOrExpr<P, any>);\n\ntype SlotType<P> =\n  | \"slot\"\n  | ({\n      type: \"slot\";\n      /**\n       * The unique names of all code components that can be placed in the slot\n       */\n      allowedComponents?: string[];\n      /**\n       * Whether the \"empty slot\" placeholder should be hidden in the canvas.\n       */\n      hidePlaceholder?: boolean;\n      /**\n       * Whether the slot is repeated, i.e., is rendered multiple times using\n       * repeatedElement().\n       */\n      isRepeated?: boolean;\n    } & Omit<\n      DefaultValueOrExpr<P, PlasmicElement | PlasmicElement[]>,\n      \"defaultValueHint\" | \"defaultExpr\" | \"defaultExprHint\"\n    >);\n\ntype ImageUrlType<P> =\n  | \"imageUrl\"\n  | ({\n      type: \"imageUrl\";\n    } & DefaultValueOrExpr<P, string> &\n      PropTypeBase<P>);\n\nexport type PrimitiveType<P = any> = Extract<\n  StringType<P> | BooleanType<P> | NumberType<P> | JSONLikeType<P>,\n  String\n>;\n\ntype ControlTypeBase =\n  | {\n      editOnly?: false;\n    }\n  | {\n      editOnly: true;\n      /**\n       * The prop where the values should be mapped to\n       */\n      uncontrolledProp?: string;\n    };\n\nexport type SupportControlled<T> =\n  | Extract<T, String | CustomControl<any>>\n  | (Exclude<T, String | CustomControl<any>> & ControlTypeBase);\n\nexport type PropType<P> =\n  | SupportControlled<\n      | StringType<P>\n      | BooleanType<P>\n      | NumberType<P>\n      | JSONLikeType<P>\n      | ChoiceType<P>\n      | ImageUrlType<P>\n      | CustomType<P>\n      | GraphQLType<P>\n    >\n  | SlotType<P>;\n\ntype RestrictPropType<T, P> = T extends string\n  ? SupportControlled<\n      | StringType<P>\n      | ChoiceType<P>\n      | JSONLikeType<P>\n      | ImageUrlType<P>\n      | CustomType<P>\n    >\n  : T extends boolean\n  ? SupportControlled<BooleanType<P> | JSONLikeType<P> | CustomType<P>>\n  : T extends number\n  ? SupportControlled<NumberType<P> | JSONLikeType<P> | CustomType<P>>\n  : PropType<P>;\n\nexport interface ActionProps<P> {\n  componentProps: P;\n  /**\n   * `contextData` can be `null` if the prop controls are rendering before\n   * the component instance itself (it will re-render once the component\n   * calls `setControlContextData`)\n   */\n  contextData: InferDataType<P> | null;\n  studioOps: {\n    showModal: (\n      modalProps: Omit<ModalProps, \"onClose\"> & { onClose?: () => void }\n    ) => void;\n    refreshQueryData: () => void;\n    appendToSlot: (element: PlasmicElement, slotName: string) => void;\n    removeFromSlotAt: (pos: number, slotName: string) => void;\n    updateProps: (newValues: any) => void;\n  };\n  /**\n   * The document that the component will be rendered into; instead of using\n   * `document` directly (for, say, `document.querySelector()` etc.), you\n   * should use this instead.\n   */\n  studioDocument: typeof document;\n}\n\nexport type Action<P> =\n  | {\n      type: \"button-action\";\n      label: string;\n      onClick: (props: ActionProps<P>) => void;\n    }\n  | {\n      type: \"custom-action\";\n      control: React.ComponentType<ActionProps<P>>;\n    };\n\ntype DistributedKeyOf<T> = T extends any ? keyof T : never;\n\ninterface ComponentTemplate<P>\n  extends Omit<CodeComponentElement<P>, \"type\" | \"name\"> {\n  /**\n   * A preview picture for the template.\n   */\n  previewImg?: string;\n}\n\nexport interface ComponentTemplates<P> {\n  [name: string]: ComponentTemplate<P>;\n}\ninterface $State {\n  [key: string]: any;\n}\n\ninterface $StateSpec<T> {\n  // Whether this state is private, readonly, or writable in\n  // this component\n  type: \"private\" | \"readonly\" | \"writable\";\n  // if initial value is defined by a js expression\n  initFunc?: ($props: Record<string, any>, $state: $State) => T;\n  // if initial value is a hard-coded value\n  initVal?: T;\n  // Whether this state is private, readonly, or writable in\n  // this component\n\n  // If writable, there should be a valueProp that maps props[valueProp]\n  // to the value of the state\n  valueProp?: string;\n\n  // If writable or readonly, there should be an onChangeProp where\n  // props[onChangeProp] is invoked whenever the value changes\n  onChangeProp?: string;\n}\n\nexport interface ComponentMeta<P> {\n  /**\n   * Any unique string name used to identify that component. Each component\n   * should be registered with a different `meta.name`, even if they have the\n   * same name in the code.\n   */\n  name: string;\n  /**\n   * The name to be displayed for the component in Studio. Optional: if not\n   * specified, `meta.name` is used.\n   */\n  displayName?: string;\n  /**\n   * The description of the component to be shown in Studio.\n   */\n  description?: string;\n  /**\n   * The javascript name to be used when generating code. Optional: if not\n   * provided, `meta.name` is used.\n   */\n  importName?: string;\n  /**\n   * An object describing the component properties to be used in Studio.\n   * For each `prop`, there should be an entry `meta.props[prop]` describing\n   * its type.\n   */\n  props: { [prop in DistributedKeyOf<P>]?: RestrictPropType<P[prop], P> } & {\n    [prop: string]: PropType<P>;\n  };\n  /**\n   * WIP: An object describing the component states to be used in Studio.\n   */\n  unstable__states?: Record<string, $StateSpec<any>>;\n  /**\n   * An array describing the component actions to be used in Studio.\n   */\n  actions?: Action<P>[];\n  /**\n   * Whether style sections should be shown in Studio. For styles to work, the\n   * component must accept a `className` prop. If unset, defaults to true.\n   */\n  styleSections?: boolean;\n  /**\n   * Whether the element can be repeated in Studio. If unset, defaults to true.\n   */\n  isRepeatable?: boolean;\n  /**\n   * The path to be used when importing the component in the generated code.\n   * It can be the name of the package that contains the component, or the path\n   * to the file in the project (relative to the root directory).\n   */\n  importPath: string;\n  /**\n   *  Whether the component is the default export from that path. Optional: if\n   * not specified, it's considered `false`.\n   */\n  isDefaultExport?: boolean;\n  /**\n   * The prop that expects the CSS classes with styles to be applied to the\n   * component. Optional: if not specified, Plasmic will expect it to be\n   * `className`. Notice that if the component does not accept CSS classes, the\n   * component will not be able to receive styles from the Studio.\n   */\n  classNameProp?: string;\n  /**\n   * The prop that receives and forwards a React `ref`. Plasmic only uses `ref`\n   * to interact with components, so it's not used in the generated code.\n   * Optional: If not provided, the usual `ref` is used.\n   */\n  refProp?: string;\n  /**\n   * Default styles to start with when instantiating the component in Plasmic.\n   */\n  defaultStyles?: CSSProperties;\n  /**\n   * Component templates to start with on Plasmic.\n   */\n  templates?: ComponentTemplates<P>;\n  /**\n   * Registered name of parent component, used for grouping related components.\n   */\n  parentComponentName?: string;\n  /**\n   * Whether the component can be used as an attachment to an element.\n   */\n  isAttachment?: boolean;\n  /**\n   * Whether the component provides data to its slots using DataProvider.\n   */\n  providesData?: boolean;\n}\n\nexport interface ComponentRegistration {\n  component: React.ComponentType<any>;\n  meta: ComponentMeta<any>;\n}\n\ndeclare global {\n  interface Window {\n    __PlasmicComponentRegistry: ComponentRegistration[];\n  }\n}\n\nif (root.__PlasmicComponentRegistry == null) {\n  root.__PlasmicComponentRegistry = [];\n}\n\nexport default function registerComponent<T extends React.ComponentType<any>>(\n  component: T,\n  meta: ComponentMeta<React.ComponentProps<T>>\n) {\n  root.__PlasmicComponentRegistry.push({ component, meta });\n}\n","import {\n  BooleanType,\n  ChoiceType,\n  CustomType,\n  JSONLikeType,\n  NumberType,\n  StringType,\n  SupportControlled,\n} from \"./registerComponent\";\n\nconst root = globalThis as any;\n\nexport type PropType<P> = SupportControlled<\n  | StringType<P>\n  | BooleanType<P>\n  | NumberType<P>\n  | JSONLikeType<P>\n  | ChoiceType<P>\n  | CustomType<P>\n>;\n\ntype RestrictPropType<T, P> = T extends string\n  ? SupportControlled<\n      StringType<P> | ChoiceType<P> | JSONLikeType<P> | CustomType<P>\n    >\n  : T extends boolean\n  ? SupportControlled<BooleanType<P> | JSONLikeType<P> | CustomType<P>>\n  : T extends number\n  ? SupportControlled<NumberType<P> | JSONLikeType<P> | CustomType<P>>\n  : PropType<P>;\n\ntype DistributedKeyOf<T> = T extends any ? keyof T : never;\n\nexport interface GlobalContextMeta<P> {\n  /**\n   * Any unique string name used to identify that context. Each context\n   * should be registered with a different `meta.name`, even if they have the\n   * same name in the code.\n   */\n  name: string;\n  /**\n   * The name to be displayed for the context in Studio. Optional: if not\n   * specified, `meta.name` is used.\n   */\n  displayName?: string;\n  /**\n   * The description of the context to be shown in Studio.\n   */\n  description?: string;\n  /**\n   * The javascript name to be used when generating code. Optional: if not\n   * provided, `meta.name` is used.\n   */\n  importName?: string;\n  /**\n   * An object describing the context properties to be used in Studio.\n   * For each `prop`, there should be an entry `meta.props[prop]` describing\n   * its type.\n   */\n  props: { [prop in DistributedKeyOf<P>]?: RestrictPropType<P[prop], P> } & {\n    [prop: string]: PropType<P>;\n  };\n  /**\n   * The path to be used when importing the context in the generated code.\n   * It can be the name of the package that contains the context, or the path\n   * to the file in the project (relative to the root directory).\n   */\n  importPath: string;\n  /**\n   *  Whether the context is the default export from that path. Optional: if\n   * not specified, it's considered `false`.\n   */\n  isDefaultExport?: boolean;\n  /**\n   * The prop that receives and forwards a React `ref`. Plasmic only uses `ref`\n   * to interact with components, so it's not used in the generated code.\n   * Optional: If not provided, the usual `ref` is used.\n   */\n  refProp?: string;\n  /**\n   * Whether the global context provides data to its children using DataProvider.\n   */\n  providesData?: boolean;\n}\n\nexport interface GlobalContextRegistration {\n  component: React.ComponentType<any>;\n  meta: GlobalContextMeta<any>;\n}\n\ndeclare global {\n  interface Window {\n    __PlasmicContextRegistry: GlobalContextRegistration[];\n  }\n}\n\nif (root.__PlasmicContextRegistry == null) {\n  root.__PlasmicContextRegistry = [];\n}\n\nexport default function registerGlobalContext<\n  T extends React.ComponentType<any>\n>(component: T, meta: GlobalContextMeta<React.ComponentProps<T>>) {\n  root.__PlasmicContextRegistry.push({ component, meta });\n}\n","const root = globalThis as any;\n\nexport interface BasicTrait {\n  label?: string;\n  type: \"text\" | \"number\" | \"boolean\";\n}\n\nexport interface ChoiceTrait {\n  label?: string;\n  type: \"choice\";\n  options: string[];\n}\n\nexport type TraitMeta = BasicTrait | ChoiceTrait;\n\nexport interface TraitRegistration {\n  trait: string;\n  meta: TraitMeta;\n}\n\ndeclare global {\n  interface Window {\n    __PlasmicTraitRegistry: TraitRegistration[];\n  }\n}\n\nif (root.__PlasmicTraitRegistry == null) {\n  root.__PlasmicTraitRegistry = [];\n}\n\nexport default function registerTrait(trait: string, meta: TraitMeta) {\n  root.__PlasmicTraitRegistry.push({\n    trait,\n    meta,\n  });\n}\n","import { cloneElement, isValidElement } from \"react\";\n\n/**\n * Allows elements to be repeated in Plasmic Studio.\n * @param index The index of the copy (starting at 0).\n * @param elt the React element to be repeated (or an array of such).\n */\nexport default function repeatedElement<T>(index: number, elt: T): T;\n/**\n * Allows elements to be repeated in Plasmic Studio.\n * @param isPrimary should be true for at most one instance of the element, and\n * indicates which copy of the element will be highlighted when the element is\n * selected in Studio.\n * @param elt the React element to be repeated (or an array of such).\n */\nexport default function repeatedElement<T>(isPrimary: boolean, elt: T): T;\nexport default function repeatedElement<T>(index: boolean | number, elt: T): T {\n  return repeatedElementFn(index as any, elt);\n}\n\nlet repeatedElementFn: typeof repeatedElement = (\n  index: boolean | number,\n  elt: any\n) => {\n  if (Array.isArray(elt)) {\n    return elt.map((v) => repeatedElementFn(index as any, v)) as any;\n  }\n  if (elt && isValidElement(elt) && typeof elt !== \"string\") {\n    return cloneElement(elt) as any;\n  }\n  return elt;\n};\n\nconst root = globalThis as any;\nexport const setRepeatedElementFn: (fn: typeof repeatedElement) => void =\n  root?.__Sub?.setRepeatedElementFn ??\n  function (fn: typeof repeatedElement) {\n    repeatedElementFn = fn;\n  };\n","export const hostVersion = \"1.0.80\";\n","import * as React from \"react\";\nimport * as ReactDOM from \"react-dom\";\nimport { registerRenderErrorListener, setPlasmicRootNode } from \"./canvas-host\";\nimport * as hostModule from \"./exports\";\nimport { setRepeatedElementFn } from \"./repeatedElement\";\n// version.ts is automatically generated by `yarn build` and not committed.\nimport { hostVersion } from \"./version\";\n\n// All exports must come from \"./exports\"\nexport * from \"./exports\";\n\nconst root = globalThis as any;\n\nif (root.__Sub == null) {\n  // Creating a side effect here by logging, so that vite won't\n  // ignore this block for whatever reason. Hiding this for now\n  // as users are complaining; will have to check if this has\n  // been fixed with vite.\n  // console.log(\"Plasmic: Setting up app host dependencies\");\n  root.__Sub = {\n    React,\n    ReactDOM,\n    hostModule,\n    hostVersion,\n    hostUtils: {\n      setPlasmicRootNode,\n      registerRenderErrorListener,\n      setRepeatedElementFn,\n    },\n\n    // For backwards compatibility:\n    setPlasmicRootNode,\n    registerRenderErrorListener,\n    setRepeatedElementFn,\n    ...hostModule,\n  };\n}\n"],"names":["isString","x","ensure","msg","undefined","Error","useForceUpdate","useState","setTick","update","useCallback","tick","root","globalThis","__PlasmicHostVersion","rootChangeListeners","PlasmicRootNodeWrapper","value","val","forEach","f","plasmicRootNode","getPlasmicOrigin","params","URL","location","hash","replace","searchParams","get","renderStudioIntoIframe","script","document","createElement","plasmicOrigin","src","body","appendChild","renderCount","setPlasmicRootNode","node","set","PlasmicCanvasContext","React","usePlasmicCanvasContext","_PlasmicCanvasHost","isFrameAttached","window","parent","isCanvas","match","isLive","shouldRenderStudio","querySelector","locationHash","URLSearchParams","JSON","parse","activeGlobalVariants","setActiveGlobalVariants","forceUpdate","push","index","indexOf","splice","scriptElt","id","async","onload","__GetlibsReadyResolver","head","append","listener","event","data","source","addEventListener","removeEventListener","appDiv","classList","add","plasmicContextValue","componentName","globalVariants","ReactDOM","ErrorBoundary","key","Provider","encodeURIComponent","href","style","width","height","border","position","top","left","zIndex","PlasmicCanvasHost","props","enableWebpackHmr","setNode","DisableWebpackHmr","renderErrorListeners","registerRenderErrorListener","state","getDerivedStateFromError","error","componentDidCatch","render","message","children","process","env","NODE_ENV","type","dangerouslySetInnerHTML","__html","tuple","args","DataContext","createContext","mkMetaName","name","mkMetaValue","meta","applySelector","rawData","selector","curData","split","useSelector","useDataEnv","useSelectors","selectors","Object","fromEntries","entries","filter","map","useContext","DataProvider","hidden","label","existingEnv","PageParamsProvider","query","$ctx","DataCtxReader","__PlasmicFetcherRegistry","registerFetcher","fetcher","__PlasmicComponentRegistry","registerComponent","component","__PlasmicContextRegistry","registerGlobalContext","__PlasmicTraitRegistry","registerTrait","trait","repeatedElement","elt","repeatedElementFn","Array","isArray","v","isValidElement","cloneElement","setRepeatedElementFn","__Sub","fn","hostVersion","hostModule","hostUtils"],"mappings":"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"}